<div class="container">

  <div class="row m-4 column-gap-2 justify-content-center">
    <div class="col-auto">

      <!-- Poke card -->
      <mat-card appearance="outlined" class="border-0 py-4 px-5">
        <mat-card-header>
          <mat-card-title class="fw-bolder">Poke Regular</mat-card-title>
          <mat-card-subtitle>Completa il tuo poke selezionando gli ingredienti che preferisci</mat-card-subtitle>
        </mat-card-header>

        <!-- Ingredient list -->
        <mat-card-content class="mt-3 ingredient-list w-100">

          @if(loading()){
            <div class="d-flex justify-content-center m-auto w-100 my-3">
              <mat-spinner></mat-spinner>
            </div>
          } @else{

            @for (ingredient of pokeService.ingredientsData(); track ingredient.id) {

              <div class="ingredient-item">
                <div class="ingredient-item-header">
                  <div class="ingredient-name">{{ingredient.name}}</div>
                  <div class="ingredient-price">(+{{ingredient.price|currency}})</div>
                </div>

                <div class="ingredient-actions">
                  @let ingredientInCart = cartService.cartIngredientsById()[ingredient.id];
                  @if(ingredientInCart){
                    <button mat-icon-button (click)="removeIngredient(ingredient)">
                      <mat-icon>remove</mat-icon>
                    </button>
                    <div>
                      {{ingredientInCart.quantity}}
                    </div>
                  }
                  <button mat-icon-button (click)="addIngredient(ingredient)" [disabled]="cartService.cartFull()">
                    <mat-icon>add</mat-icon>
                  </button>
                </div>
              </div>

            } @empty {
              <div>Nessun ingrediente disponibile</div>
            }

            <app-bowl-name-selector/>

          }


        </mat-card-content>

      </mat-card>
    </div>

    <!-- Poke image -->
    <div class="col-auto align-self-center">
      <img ngSrc="/assets/poke.png" alt="poke" class="poke-img" height="788" width="788">
    </div>
  </div>

</div>

<mat-toolbar class="fixed-bottom">
  <div class="container px-5 d-flex justify-content-between align-items-center">

    @let cartPrice =cartService.cartPrice();
    <div class="total-amount">Totale: {{cartPrice==undefined? '-' : (cartPrice|currency)}}</div>
    <button mat-flat-button color="primary" (click)="confirm()" [disabled]="cannotConfirm()">Conferma</button>

  </div>

</mat-toolbar>
